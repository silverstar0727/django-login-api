user root;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
    worker_connections 768;
}
http {
    sendfile on; # 커널 영역의 buffer를 사용하여 속도 향상
    tcp_nopush on; # sendfile이 on일 때 TCP_CORK을 통해 모아서 한번에 패킷 전송
    tcp_nodelay on; # 바로바로 전송하는 옵션 -> nopush와 상충되는 듯 하나 0.2초의 delay
    keepalive_timeout 65; # 커넥션 유지 시간 
    types_hash_max_size 2048; # host domain namespace
    client_max_body_size 256M; # 
    proxy_connect_timeout   10;
    proxy_send_timeout      15;
    proxy_read_timeout      20;

    server_names_hash_bucket_size 64;

    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # SSL Settings
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE
    ssl_prefer_server_ciphers on;

    # Logging Settings
    access_log /log/access.log;
    error_log /log/error.log;

    # Gzip Settings
    gzip on;

    # Virtual Host Configs
    include /etc/nginx/sites-enabled/*.conf;
}